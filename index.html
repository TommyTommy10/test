<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#000000">
  <title>Buon Compleanno!</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(45deg, #f3ec78, #af4261);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    
    .phone {
      width: 320px;
      height: 650px;
      background-color: #121212;
      border-radius: 36px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5);
      border: 8px solid #2a2a2a;
    }
    
    .screen {
      position: absolute;
      top: 12px;
      left: 12px;
      right: 12px;
      bottom: 12px;
      background: #000;
      border-radius: 24px;
      overflow: hidden;
    }
    
    .notch {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 150px;
      height: 30px;
      background-color: #000;
      border-bottom-left-radius: 18px;
      border-bottom-right-radius: 18px;
      z-index: 10;
    }
    
    .status-bar {
      height: 44px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 22px;
      color: white;
      font-size: 14px;
      font-weight: bold;
      background-color: #000;
      position: relative;
      z-index: 5;
    }
    
    .home-screen {
      position: absolute;
      top: 44px;
      left: 0;
      right: 0;
      bottom: 80px;
      display: flex;
      flex-direction: column;
      padding: 20px 15px;
      overflow-y: auto;
      background: url('https://source.unsplash.com/random/320x650/?stars') center/cover no-repeat;
    }
    
    .app-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-gap: 16px;
      margin-top: 10px;
    }
    
    .app {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    
    .app-icon {
      width: 55px;
      height: 55px;
      border-radius: 14px;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 22px;
      margin-bottom: 6px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }
    
    .app-name {
      font-size: 10px;
      color: white;
      text-shadow: 0 0 5px rgba(0, 0, 0, 0.8);
    }
    
    .dock {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 80px;
      display: flex;
      justify-content: space-around;
      align-items: center;
      background-color: rgba(30, 30, 30, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 0 0 24px 24px;
      padding: 0 15px;
    }
    
    .dock-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 22px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }
    
    .app-screen {
      position: absolute;
      top: 44px;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #f2f2f7;
      display: none;
      flex-direction: column;
      z-index: 20;
      overflow: hidden;
    }
    
    .app-header {
      height: 50px;
      background-color: #f2f2f7;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 15px;
      border-bottom: 1px solid #ddd;
      font-weight: bold;
    }
    
    .back-btn {
      font-weight: bold;
      color: #007AFF;
      cursor: pointer;
    }
    
    .app-title {
      font-size: 17px;
      color: #333;
    }
    
    .app-content {
      flex: 1;
      overflow-y: auto;
      padding: 15px;
    }
    
    /* Notes App Styles */
    .diary-entry {
      background-color: #fff;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    
    .diary-date {
      font-size: 12px;
      color: #888;
      margin-bottom: 5px;
    }
    
    .diary-title {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #333;
    }
    
    .diary-content {
      font-size: 14px;
      color: #555;
      line-height: 1.4;
    }
    
    /* Photos App Styles */
    .photos-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-gap: 10px;
    }
    
    .memory {
      height: 150px;
      border-radius: 10px;
      overflow: hidden;
      position: relative;
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
    }
    
    .memory img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .memory-caption {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      padding: 8px;
      font-size: 12px;
    }
    
    /* Music App Styles */
    .music-categories {
      display: flex;
      margin-bottom: 15px;
    }
    
    .category {
      padding: 8px 12px;
      background-color: #007AFF;
      color: white;
      border-radius: 20px;
      margin-right: 10px;
      font-size: 14px;
      cursor: pointer;
    }
    
    .category.active {
      background-color: #FF2D55;
    }
    
    .song {
      display: flex;
      align-items: center;
      padding: 12px;
      background-color: white;
      border-radius: 10px;
      margin-bottom: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .song-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
      background-color: #ddd;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
    }
    
    .song-info {
      flex: 1;
    }
    
    .song-title {
      font-weight: bold;
      font-size: 14px;
      margin-bottom: 4px;
      color: #333;
    }
    
    .song-artist {
      font-size: 12px;
      color: #888;
    }
    
    /* Calendar App Styles */
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .month-year {
      font-size: 18px;
      font-weight: bold;
      color: #333;
    }
    
    .days-of-week {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      text-align: center;
      margin-bottom: 5px;
    }
    
    .day-name {
      font-size: 12px;
      color: #888;
      padding: 5px;
    }
    
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      grid-gap: 5px;
    }
    
    .calendar-day {
      height: 40px;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 50%;
      font-size: 14px;
      color: #333;
    }
    
    .birthday {
      background-color: #FF2D55;
      color: white;
      font-weight: bold;
    }
    
    .birthday::after {
      content: "🎂";
      position: absolute;
      font-size: 10px;
      margin-top: 25px;
    }
    
    .today {
      border: 2px solid #007AFF;
    }
    
    .other-month {
      opacity: 0.3;
    }
    
    /* Messages App Styles */
    .message {
      margin-bottom: 15px;
      display: flex;
      flex-direction: column;
    }
    
    .message.sent {
      align-items: flex-end;
    }
    
    .message.received {
      align-items: flex-start;
    }
    
    .message-bubble {
      max-width: 80%;
      padding: 10px 15px;
      border-radius: 18px;
      font-size: 14px;
      margin-bottom: 2px;
    }
    
    .sent .message-bubble {
      background-color: #007AFF;
      color: white;
      border-bottom-right-radius: 4px;
    }
    
    .received .message-bubble {
      background-color: #E5E5EA;
      color: #333;
      border-bottom-left-radius: 4px;
    }
    
    .message-time {
      font-size: 10px;
      color: #888;
      margin: 2px 5px;
    }
    
    /* Countdown App Styles */
    .countdown-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      background: linear-gradient(135deg, #FF6B6B, #4ECDC4);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    
    .birthday-title {
      font-size: 24px;
      font-weight: bold;
      color: white;
      margin-bottom: 15px;
      text-align: center;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    
    .countdown-digits {
      display: flex;
      margin: 20px 0;
    }
    
    .digit-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0 10px;
    }
    
    .digit {
      width: 50px;
      height: 60px;
      background-color: rgba(255, 255, 255, 0.9);
      border-radius: 8px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    .digit-label {
      margin-top: 5px;
      font-size: 12px;
      color: white;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    .birthday-message {
      margin-top: 20px;
      font-size: 16px;
      color: white;
      text-align: center;
      line-height: 1.4;
      max-width: 80%;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }
    
    .birthday-gif {
      width: 100px;
      height: 100px;
      margin-top: 15px;
      border-radius: 50%;
      overflow: hidden;
      border: 3px solid white;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    /* Lock Screen Styles */
.lock-screen {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url('https://source.unsplash.com/random/320x650/?nature') center/cover no-repeat;
  z-index: 100;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  color: white;
}

.lock-screen-time {
  text-align: center;
  padding-top: 60px;
}

.lock-screen-time .time {
  font-size: 68px;
  font-weight: 200;
  text-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.lock-screen-time .date {
  font-size: 20px;
  margin-top: 5px;
  text-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.lock-screen-bottom {
  padding: 20px;
  text-align: center;
  background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
  padding-top: 100px;
}

.unlock-text {
  font-size: 16px;
  margin-bottom: 15px;
  text-shadow: 0 2px 5px rgba(0,0,0,0.5);
}

.unlock-hint {
  font-size: 14px;
  opacity: 0.8;
  text-shadow: 0 2px 5px rgba(0,0,0,0.5);
}

/* Notifications on Lock Screen */
.notifications {
  padding: 20px;
  margin-top: auto;
  margin-bottom: 20px;
}

.notification {
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(10px);
  border-radius: 15px;
  padding: 15px;
  margin-bottom: 10px;
  border: 1px solid rgba(255,255,255,0.2);
}

.notification-title {
  font-weight: bold;
  margin-bottom: 5px;
}

.notification-text {
  font-size: 14px;
  opacity: 0.9;
}

/* PIN Code Screen */
.pin-screen {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.9);
  z-index: 101;
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: white;
}

.pin-dots {
  display: flex;
  gap: 15px;
  margin-bottom: 30px;
}

.pin-dot {
  width: 15px;
  height: 15px;
  border: 2px solid white;
  border-radius: 50%;
}

.pin-dot.filled {
  background: white;
}

.pin-pad {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-top: 20px;
}

.pin-button {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  border: 1px solid rgba(255,255,255,0.3);
  background: rgba(255,255,255,0.1);
  color: white;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s;
}

.pin-button:active {
  background: rgba(255,255,255,0.2);
}

/* Effetti di animazione */
.app-icon, .dock-icon {
    transition: transform 0.2s, opacity 0.2s;
}

.app-icon:active, .dock-icon:active {
    transform: scale(0.9);
    opacity: 0.7;
}

/* Effetto sfondo sfocato */
.home-screen {
    backdrop-filter: blur(10px);
    background-color: rgba(0, 0, 0, 0.1);
}

/* Effetti di swipe */
.app-screen {
    transition: transform 0.3s ease-out;
    transform: translateX(100%);
}

.app-screen.active {
    transform: translateX(0);
}

/* Effetto rimbalzo per le icone */
@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
}

.app:hover .app-icon {
    animation: bounce 0.5s ease infinite;
}

/* Miglioramenti visivi per il dock */
.dock {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    margin: 0 10px 10px 10px;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

    /* Effetti meteo */
.weather-effect {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 1;
}

.rain {
    position: absolute;
    width: 2px;
    height: 100px;
    background: linear-gradient(transparent, rgba(255,255,255,0.5));
    animation: rain 0.5s linear infinite;
}

@keyframes rain {
    0% { transform: translateY(-100px); }
    100% { transform: translateY(650px); }
}

/* Widget Styles */
.widget-container {
    padding: 15px;
    margin-bottom: 20px;
}

.widget {
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    padding: 15px;
    margin-bottom: 15px;
    border: 1px solid rgba(255,255,255,0.2);
    color: white;
}

.weather-widget {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.weather-info {
    display: flex;
    align-items: center;
}

.weather-temp {
    font-size: 36px;
    margin-right: 10px;
}

.weather-details {
    font-size: 14px;
}

/* Gesture Indicator */
.gesture-hint {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 40px;
    height: 4px;
    background: rgba(255,255,255,0.3);
    border-radius: 2px;
    transition: opacity 0.3s;
}

/* Sound Control */
.volume-slider {
    position: absolute;
    top: 50%;
    right: -100px;
    transform: translateY(-50%);
    width: 200px;
    height: 40px;
    background: rgba(255,255,255,0.1);
    border-radius: 20px;
    transition: right 0.3s;
    display: flex;
    align-items: center;
    padding: 0 15px;
}

.volume-slider.active {
    right: 20px;
}

/* Theme Switcher */
.theme-toggle {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 1000;
}

/* App Switching Animation */
.app-switcher {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    display: none;
    z-index: 999;
}

.app-preview {
    position: relative;
    width: 80%;
    height: 70%;
    margin: 20px auto;
    background: white;
    border-radius: 15px;
    transform: scale(0.9);
    transition: transform 0.3s;
}

.app-preview.active {
    transform: scale(1);
}

/* Correzione posizione widget */
.widget-container {
    position: absolute;
    top: 60px; /* Spazio per la status bar */
    left: 0;
    right: 0;
    z-index: 1; /* Assicura che i widget siano sotto le app */
}

/* Stile per app screen aggiornato */
.app-screen {
    position: absolute;
    top: 44px;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #f2f2f7;
    display: none;
    flex-direction: column;
    z-index: 20; /* Assicura che le app siano sopra i widget */
}

/* Effetti particellari */
.particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 0;
}

/* Modalità risparmio energetico */
.power-saving {
    filter: grayscale(1) brightness(0.8);
}

/* Gesture animations */
.pinch-area {
    transform-origin: center;
    transition: transform 0.3s ease;
}

/* Calendar sync indicator */
.sync-indicator {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #4CD964;
    opacity: 0;
    transition: opacity 0.3s;
}

.sync-indicator.syncing {
    animation: pulse 1s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.2); opacity: 0.5; }
    100% { transform: scale(1); opacity: 1; }
}

/* Push Notification Style */
.push-notification {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 12px 20px;
    border-radius: 12px;
    font-size: 14px;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s, transform 0.3s;
}

.push-notification.show {
    opacity: 1;
    transform: translateX(-50%) translateY(10px);
}
  </style>
</head>
<body>
  <div class="phone">
    <div class="screen">
      <div class="notch"></div>
      <div class="status-bar">
        <span class="time">9:41</span>
        <span class="battery">100%</span>
      </div>
      
      <!-- Home Screen -->
      <div class="home-screen" id="home-screen">
        <div class="app-grid">
          <div class="app" onclick="openApp('notes')">
            <div class="app-icon" style="background-color: #FF9500;">📝</div>
            <div class="app-name">Diario</div>
          </div>
          <div class="app" onclick="openApp('photos')">
            <div class="app-icon" style="background-color: #5856D6;">🖼️</div>
            <div class="app-name">Ricordi</div>
          </div>
          <div class="app" onclick="openApp('music')">
            <div class="app-icon" style="background-color: #FF2D55;">🎵</div>
            <div class="app-name">Musica</div>
          </div>
          <div class="app" onclick="openApp('calendar')">
            <div class="app-icon" style="background-color: #4CD964;">📅</div>
            <div class="app-name">Calendario</div>
          </div>
          <div class="app" onclick="openApp('messages')">
            <div class="app-icon" style="background-color: #007AFF;">💬</div>
            <div class="app-name">Messaggi</div>
          </div>
          <div class="app" onclick="openApp('countdown')">
            <div class="app-icon" style="background-color: #FF3B30;">🎂</div>
            <div class="app-name">Countdown</div>
          </div>
          <div class="app" onclick="alert('Buon Compleanno! 🎉')">
            <div class="app-icon" style="background-color: #007AFF;">🎉</div>
            <div class="app-name">Sorpresa</div>
          </div>
          <div class="app" onclick="alert('Ti voglio bene! ❤️')">
            <div class="app-icon" style="background-color: #FF2D55;">❤️</div>
            <div class="app-name">Cuore</div>
          </div>
        </div>
      </div>

      <div class="widget-container">
    <div class="widget weather-widget">
        <div class="weather-info">
            <div class="weather-temp">22°</div>
            <div class="weather-details">
                <div>Soleggiato</div>
                <div>Umidità: 45%</div>
            </div>
        </div>
        <div class="weather-icon">☀️</div>
    </div>
    
    <div class="widget music-widget">
        <div style="display: flex; align-items: center;">
            <div style="width: 50px; height: 50px; background: rgba(255,255,255,0.2); border-radius: 8px; margin-right: 10px;"></div>
            <div>
                <div style="font-weight: bold;">La tua canzone preferita</div>
                <div style="font-size: 12px; opacity: 0.8;">Artista - Album</div>
            </div>
        </div>
        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
            <span>⏮️</span>
            <span style="font-size: 24px;">⏸️</span>
            <span>⏭️</span>
        </div>
    </div>
</div>

<div class="gesture-hint"></div>
<div class="volume-slider">
    <input type="range" min="0" max="100" value="50" style="width: 100%;">
</div>
<div class="theme-toggle">🌓</div>

<div class="weather-effect"></div>
      
      <div class="dock">
        <div class="dock-icon" style="background-color: #FF9500;" onclick="openApp('notes')">📝</div>
        <div class="dock-icon" style="background-color: #5856D6;" onclick="openApp('photos')">🖼️</div>
        <div class="dock-icon" style="background-color: #FF2D55;" onclick="openApp('music')">🎵</div>
        <div class="dock-icon" style="background-color: #4CD964;" onclick="openApp('calendar')">📅</div>
      </div>

      <div class="particles"></div>
<div class="sync-indicator"></div>
<div class="push-notification" id="pushNotification">
    <div class="notification-title"></div>
    <div class="notification-body"></div>
</div>
      
      <!-- Notes App -->
      <div class="app-screen" id="notes-app">
        <div class="app-header">
          <div class="back-btn" onclick="closeApp('notes')">Indietro</div>
          <div class="app-title">Diario</div>
          <div></div>
        </div>
        <div class="app-content">
          <div class="diary-entry">
            <div class="diary-date">24 Giugno 2024</div>
            <div class="diary-title">Buon Compleanno! 🎂</div>
            <div class="diary-content">
              Oggi è il tuo compleanno e volevo crearti qualcosa di speciale. Tra tutti i ricordi che abbiamo vissuto insieme, volevo regalarti un modo per tenerli sempre con te. Spero che questo piccolo "telefono virtuale" ti faccia sorridere. Sei una persona speciale nella mia vita.
            </div>
          </div>
          <div class="diary-entry">
            <div class="diary-date">23 Giugno 2024</div>
            <div class="diary-title">Preparazione 🎁</div>
            <div class="diary-content">
              Sto preparando tutto per il tuo compleanno. Non vedo l'ora di festeggiare con te! Ho pensato a lungo a cosa regalarti e spero che questo regalo speciale ti piaccia.
            </div>
          </div>
          <div class="diary-entry">
            <div class="diary-date">15 Maggio 2024</div>
            <div class="diary-title">Ricordi 💭</div>
            <div class="diary-content">
              Oggi stavo ripensando a tutte le avventure che abbiamo vissuto insieme. Dai momenti più divertenti a quelli più difficili, ci siamo sempre sostenuti a vicenda. La nostra amicizia è davvero speciale.
            </div>
          </div>
          <div class="diary-entry">
            <div class="diary-date">1 Aprile 2024</div>
            <div class="diary-title">Scherzi e Risate 😂</div>
            <div class="diary-content">
              Oggi ti ho fatto uno scherzo per il pesce d'aprile! La tua reazione è stata impagabile. Mi piace come riusciamo sempre a ridere insieme anche nelle situazioni più assurde.
            </div>
          </div>
        </div>
      </div>
      
      <!-- Photos App -->
      <div class="app-screen" id="photos-app">
        <div class="app-header">
          <div class="back-btn" onclick="closeApp('photos')">Indietro</div>
          <div class="app-title">Ricordi</div>
          <div></div>
        </div>
        <div class="app-content">
          <div class="photos-grid">
            <div class="memory">
              <img src="/api/placeholder/400/320" alt="Ricordo 1">
              <div class="memory-caption">Il nostro primo viaggio insieme</div>
            </div>
            <div class="memory">
              <img src="/api/placeholder/400/320" alt="Ricordo 2">
              <div class="memory-caption">Festa di Capodanno 2024</div>
            </div>
            <div class="memory">
              <img src="/api/placeholder/400/320" alt="Ricordo 3">
              <div class="memory-caption">Quella volta al concerto</div>
            </div>
            <div class="memory">
              <img src="/api/placeholder/400/320" alt="Ricordo 4">
              <div class="memory-caption">Giornata al mare</div>
            </div>
            <div class="memory">
              <img src="/api/placeholder/400/320" alt="Ricordo 5">
              <div class="memory-caption">Il tuo compleanno scorso</div>
            </div>
            <div class="memory">
              <img src="/api/placeholder/400/320" alt="Ricordo 6">
              <div class="memory-caption">Serata cinema</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Music App -->
      <div class="app-screen" id="music-app">
        <div class="app-header">
          <div class="back-btn" onclick="closeApp('music')">Indietro</div>
          <div class="app-title">Musica</div>
          <div></div>
        </div>
        <div class="app-content">
          <div class="music-categories">
            <div class="category active" id="yours-btn" onclick="switchMusicCategory('yours')">Yours</div>
            <div class="category" id="mine-btn" onclick="switchMusicCategory('mine')">Mine</div>
          </div>
          
          <div id="yours-playlist">
            <div class="song">
              <div class="song-cover">🎵</div>
              <div class="song-info">
                <div class="song-title">La tua canzone preferita</div>
                <div class="song-artist">Il tuo artista preferito</div>
              </div>
            </div>
            <div class="song">
              <div class="song-cover">🎵</div>
              <div class="song-info">
                <div class="song-title">Quella canzone che cantiamo sempre</div>
                <div class="song-artist">Artista Famoso</div>
              </div>
            </div>
            <div class="song">
              <div class="song-cover">🎵</div>
              <div class="song-info">
                <div class="song-title">La canzone che mi hai fatto scoprire</div>
                <div class="song-artist">Band Indie</div>
              </div>
            </div>
            <div class="song">
              <div class="song-cover">🎵</div>
              <div class="song-info">
                <div class="song-title">La tua hit dell'estate</div>
                <div class="song-artist">Pop Star</div>
              </div>
            </div>
          </div>
          
          <div id="mine-playlist" style="display: none;">
            <div class="song">
              <div class="song-cover">🎵</div>
              <div class="song-info">
                <div class="song-title">La mia canzone preferita</div>
                <div class="song-artist">Il mio artista preferito</div>
              </div>
            </div>
            <div class="song">
              <div class="song-cover">🎵</div>
              <div class="song-info">
                <div class="song-title">Quella che ascolto quando penso a te</div>
                <div class="song-artist">Cantautore Famoso</div>
              </div>
            </div>
            <div class="song">
              <div class="song-cover">🎵</div>
              <div class="song-info">
                <div class="song-title">La canzone che mi ricorda di noi</div>
                <div class="song-artist">Rock Band</div>
              </div>
            </div>
            <div class="song">
              <div class="song-cover">🎵</div>
              <div class="song-info">
                <div class="song-title">La colonna sonora della nostra amicizia</div>
                <div class="song-artist">Duo Musicale</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Calendar App -->
      <div class="app-screen" id="calendar-app">
        <div class="app-header">
          <div class="back-btn" onclick="closeApp('calendar')">Indietro</div>
          <div class="app-title">Calendario</div>
          <div></div>
        </div>
        <div class="app-content">
          <div class="calendar-header">
            <div class="month-year">Giugno 2024</div>
          </div>
          <div class="days-of-week">
            <div class="day-name">Lun</div>
            <div class="day-name">Mar</div>
            <div class="day-name">Mer</div>
            <div class="day-name">Gio</div>
            <div class="day-name">Ven</div>
            <div class="day-name">Sab</div>
            <div class="day-name">Dom</div>
          </div>
          <div class="calendar-grid">
            <!-- Week 1 -->
            <div class="calendar-day other-month">27</div>
            <div class="calendar-day other-month">28</div>
            <div class="calendar-day other-month">29</div>
            <div class="calendar-day other-month">30</div>
            <div class="calendar-day other-month">31</div>
            <div class="calendar-day">1</div>
            <div class="calendar-day">2</div>
            <!-- Week 2 -->
            <div class="calendar-day">3</div>
            <div class="calendar-day">4</div>
            <div class="calendar-day">5</div>
            <div class="calendar-day">6</div>
            <div class="calendar-day">7</div>
            <div class="calendar-day">8</div>
            <div class="calendar-day">9</div>
            <!-- Week 3 -->
            <div class="calendar-day">10</div>
            <div class="calendar-day">11</div>
            <div class="calendar-day">12</div>
            <div class="calendar-day">13</div>
            <div class="calendar-day">14</div>
            <div class="calendar-day">15</div>
            <div class="calendar-day">16</div>
            <!-- Week 4 -->
            <div class="calendar-day">17</div>
            <div class="calendar-day">18</div>
            <div class="calendar-day">19</div>
            <div class="calendar-day">20</div>
            <div class="calendar-day today">21</div>
            <div class="calendar-day">22</div>
            <div class="calendar-day">23</div>
            <!-- Week 5 -->
            <div class="calendar-day birthday">24</div>
            <div class="calendar-day">25</div>
            <div class="calendar-day">26</div>
            <div class="calendar-day">27</div>
            <div class="calendar-day">28</div>
            <div class="calendar-day">29</div>
            <div class="calendar-day">30</div>
          </div>
        </div>
      </div>
      
      <!-- Messages App -->
      <div class="app-screen" id="messages-app">
        <div class="app-header">
          <div class="back-btn" onclick="closeApp('messages')">Indietro</div>
          <div class="app-title">Messaggi</div>
          <div></div>
        </div>
        <div class="app-content">
          <div class="message received">
            <div class="message-bubble">Ciao! Come stai?</div>
            <div class="message-time">10:15</div>
          </div>
          <div class="message sent">
            <div class="message-bubble">Tutto bene! E tu?</div>
            <div class="message-time">10:17</div>
          </div>
          <div class="message received">
            <div class="message-bubble">Bene grazie! Hai dei programmi per il tuo compleanno?</div>
            <div class="message-time">10:19</div>
          </div>
          <div class="message sent">
            <div class="message-bubble">Ancora non so! Mi piacerebbe festeggiare con gli amici...</div>
            <div class="message-time">10:22</div>
          </div>
          <div class="message received">
            <div class="message-bubble">Ho un regalo speciale per te! 🎁</div>
            <div class="message-time">10:23</div>
          </div>
          <div class="message sent">
            <div class="message-bubble">Davvero? Non vedo l'ora! 😍</div>
            <div class="message-time">10:25</div>
          </div>
          <div class="message received">
            <div class="message-bubble">Ti voglio bene! Buon compleanno in anticipo! 🎉</div>
            <div class="message-time">10:26</div>
          </div>
        </div>
      </div>
      
      <!-- Countdown App -->
      <div class="app-screen" id="countdown-app">
        <div class="app-header">
          <div class="back-btn" onclick="closeApp('countdown')">Indietro</div>
          <div class="app-title">Countdown Compleanno</div>
          <div></div>
        </div>
        <div class="app-content">
          <div class="countdown-container">
            <div class="birthday-title">Buon Compleanno! 🎂</div>
            <div id="countdown-display">
              <div class="countdown-digits">
                <div class="digit-container">
                  <div class="digit" id="days">00</div>
                  <div class="digit-label">Giorni</div>
                </div>
                <div class="digit-container">
                 <div class="digit" id="hours">00</div>
                  <div class="digit-label">Ore</div>
                </div>
                <div class="digit-container">
                  <div class="digit" id="minutes">00</div>
                  <div class="digit-label">Minuti</div>
                </div>
                <div class="digit-container">
                  <div class="digit" id="seconds">00</div>
                  <div class="digit-label">Secondi</div>
                </div>
              </div>
            </div>
            <div class="birthday-message">
              Tanti auguri di buon compleanno! Ogni momento passato insieme è un tesoro per me. Grazie per essere una persona così speciale nella mia vita.
            </div>
            <div class="birthday-gif">
              <img src="/api/placeholder/100/100" alt="Birthday celebration">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Open and close apps
    function openApp(appName) {
      document.getElementById('home-screen').style.display = 'none';
      document.getElementById(appName + '-app').style.display = 'flex';
    }
    
    function closeApp(appName) {
      document.getElementById(appName + '-app').style.display = 'none';
      document.getElementById('home-screen').style.display = 'flex';
    }
    
    // Switch music categories
    function switchMusicCategory(category) {
      if (category === 'yours') {
        document.getElementById('yours-playlist').style.display = 'block';
        document.getElementById('mine-playlist').style.display = 'none';
        document.getElementById('yours-btn').classList.add('active');
        document.getElementById('mine-btn').classList.remove('active');
      } else {
        document.getElementById('yours-playlist').style.display = 'none';
        document.getElementById('mine-playlist').style.display = 'block';
        document.getElementById('yours-btn').classList.remove('active');
        document.getElementById('mine-btn').classList.add('active');
      }
    }
    
    // Countdown timer
    function updateCountdown() {
      const now = new Date();
      const currentYear = now.getFullYear();
      const birthdayDate = new Date(currentYear, 5, 24); // June 24 (month is 0-indexed)
      
      // If birthday already passed this year, set for next year
      if (now > birthdayDate) {
        birthdayDate.setFullYear(currentYear + 1);
      }
      
      const diff = birthdayDate - now;
      
      // Calculate days, hours, minutes, seconds
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);
      
      // Update the countdown display
      document.getElementById('days').innerText = days.toString().padStart(2, '0');
      document.getElementById('hours').innerText = hours.toString().padStart(2, '0');
      document.getElementById('minutes').innerText = minutes.toString().padStart(2, '0');
      document.getElementById('seconds').innerText = seconds.toString().padStart(2, '0');
    }
    
    // Update countdown every second
    updateCountdown();
    setInterval(updateCountdown, 1000);
    
    // Update time in status bar
    function updateTime() {
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const minutes = now.getMinutes().toString().padStart(2, '0');
      document.querySelector('.time').innerText = `${hours}:${minutes}`;
    }
    
    updateTime();
    setInterval(updateTime, 60000);

    // Lock Screen functionality
let currentPin = '';
const correctPin = '2406'; // PIN per il compleanno (24/06)

function updateLockScreenTime() {
  const now = new Date();
  const hours = now.getHours().toString().padStart(2, '0');
  const minutes = now.getMinutes().toString().padStart(2, '0');
  
  const days = ['Domenica', 'Lunedì', 'Martedì', 'Mercoledì', 'Giovedì', 'Venerdì', 'Sabato'];
  const months = ['Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre'];
  
  const dateStr = `${days[now.getDay()]}, ${now.getDate()} ${months[now.getMonth()]}`;
  
  document.getElementById('lock-time').innerText = `${hours}:${minutes}`;
  document.getElementById('lock-date').innerText = dateStr;
}

function showPinScreen() {
  document.getElementById('pin-screen').style.display = 'flex';
}

function enterPin(num) {
  if (currentPin.length < 4) {
    currentPin += num;
    document.querySelectorAll('.pin-dot')[currentPin.length - 1].classList.add('filled');
    
    if (currentPin.length === 4) {
      checkPin();
    }
  }
}

function clearPin() {
  currentPin = '';
  document.querySelectorAll('.pin-dot').forEach(dot => dot.classList.remove('filled'));
}

function checkPin() {
  if (currentPin === correctPin) {
    document.getElementById('pin-screen').style.display = 'none';
    document.getElementById('lock-screen').style.display = 'none';
    clearPin();
  } else {
    clearPin();
    alert('PIN errato! Riprova.');
  }
}

// Inizializza il lock screen
updateLockScreenTime();
setInterval(updateLockScreenTime, 1000);

// Event listener per lo sblocco
document.getElementById('lock-screen').addEventListener('long-press', showPinScreen);

// Implementazione del long-press
let pressTimer;
document.getElementById('lock-screen').addEventListener('mousedown', e => {
  pressTimer = setTimeout(showPinScreen, 1000);
});

document.getElementById('lock-screen').addEventListener('mouseup', e => {
  clearTimeout(pressTimer);
});

document.getElementById('lock-screen').addEventListener('mouseleave', e => {
  clearTimeout(pressTimer);
});

// Touch events per dispositivi mobili
document.getElementById('lock-screen').addEventListener('touchstart', e => {
  pressTimer = setTimeout(showPinScreen, 1000);
});

document.getElementById('lock-screen').addEventListener('touchend', e => {
  clearTimeout(pressTimer);
});

// Animazioni app più fluide
function openApp(appName) {
    const homeScreen = document.getElementById('home-screen');
    const appScreen = document.getElementById(appName + '-app');
    
    homeScreen.style.opacity = '0';
    homeScreen.style.display = 'none';
    
    appScreen.style.display = 'flex';
    setTimeout(() => {
        appScreen.classList.add('active');
    }, 50);
}

function closeApp(appName) {
    const homeScreen = document.getElementById('home-screen');
    const appScreen = document.getElementById(appName + '-app');
    
    appScreen.classList.remove('active');
    setTimeout(() => {
        appScreen.style.display = 'none';
        homeScreen.style.display = 'flex';
        homeScreen.style.opacity = '1';
    }, 300);
}

// Effetti di vibrazione per le interazioni
function vibrateDevice() {
    if (navigator.vibrate) {
        navigator.vibrate(50);
    }
}

// Aggiorna dinamicamente lo sfondo della home
function updateHomeBackground() {
    const hour = new Date().getHours();
    let timeOfDay;
    
    if (hour >= 5 && hour < 12) timeOfDay = 'morning';
    else if (hour >= 12 && hour < 17) timeOfDay = 'afternoon';
    else if (hour >= 17 && hour < 20) timeOfDay = 'evening';
    else timeOfDay = 'night';
    
    document.querySelector('.home-screen').style.backgroundImage = 
        `url('https://source.unsplash.com/random/320x650/?${timeOfDay},nature')`;
}

// Effetto parallasse sullo sfondo
function initParallax() {
    const homeScreen = document.querySelector('.home-screen');
    
    window.addEventListener('deviceorientation', (event) => {
        const x = event.beta * 0.2; // -180° to 180°
        const y = event.gamma * 0.2; // -90° to 90°
        
        homeScreen.style.backgroundPosition = `calc(50% + ${y}px) calc(50% + ${x}px)`;
    });
}

// Sistema di notifiche
function showNotification(title, message) {
    if ('Notification' in window && Notification.permission === 'granted') {
        new Notification(title, { body: message });
    } else if ('Notification' in window && Notification.permission !== 'denied') {
        Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
                new Notification(title, { body: message });
            }
        });
    }
}

// Calendario interattivo
function makeCalendarInteractive() {
    const calendarDays = document.querySelectorAll('.calendar-day');
    calendarDays.forEach(day => {
        day.addEventListener('click', () => {
            if (!day.classList.contains('other-month')) {
                vibrateDevice();
                const events = getEventsForDay(day.innerText);
                if (events.length > 0) {
                    alert(`Eventi del ${day.innerText}:\n${events.join('\n')}`);
                }
            }
        });
    });
}

function getEventsForDay(day) {
    const events = [];
    if (day === '24') {
        events.push('🎂 Il tuo compleanno!');
        events.push('🎉 Festa sorpresa');
        events.push('🎁 Apertura regali');
    }
    return events;
}

// Batteria e ora dinamica
function updateStatusBar() {
    const timeElement = document.querySelector('.status-bar .time');
    const batteryElement = document.querySelector('.status-bar .battery');
    
    if ('getBattery' in navigator) {
        navigator.getBattery().then(battery => {
            batteryElement.textContent = `${Math.round(battery.level * 100)}%`;
        });
    }
    
    function updateTime() {
        const now = new Date();
        timeElement.textContent = now.toLocaleTimeString('it-IT', { 
            hour: '2-digit', 
            minute: '2-digit' 
        });
    }
    
    updateTime();
    setInterval(updateTime, 1000);
}

// Inizializzazione
document.addEventListener('DOMContentLoaded', () => {
    updateHomeBackground();
    initParallax();
    makeCalendarInteractive();
    updateStatusBar();
    
    // Richiedi il permesso per le notifiche
    if ('Notification' in window) {
        Notification.requestPermission();
    }
    
    // Aggiorna lo sfondo ogni ora
    setInterval(updateHomeBackground, 3600000);
});

// Aggiungi eventi touch per tutte le app
document.querySelectorAll('.app, .dock-icon').forEach(element => {
    element.addEventListener('touchstart', vibrateDevice);
});

    // Effetti sonori
const sounds = {
    tap: new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAAFbgBra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2t//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAW7TUp2OAAAAAAAAAAAAAAAAAAAA//tYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'),
    open: new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAAFbgBra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2t//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAW7TUp2OAAAAAAAAAAAAAAAAAAAA//tYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'),
    close: new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAAFbgBra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2t//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAW7TUp2OAAAAAAAAAAAAAAAAAAAA//tYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')
};

// Riproduce suono
function playSound(soundName) {
    sounds[soundName].currentTime = 0;
    sounds[soundName].play();
}

// Gestione effetti meteo
function createWeatherEffect() {
    const weatherEffect = document.querySelector('.weather-effect');
    for(let i = 0; i < 50; i++) {
        const drop = document.createElement('div');
        drop.className = 'rain';
        drop.style.left = Math.random() * 100 + '%';
        drop.style.animationDelay = Math.random() * 2 + 's';
        weatherEffect.appendChild(drop);
    }
}

// Gesture per chiudere le app
let touchStartY = 0;
document.addEventListener('touchstart', e => {
    touchStartY = e.touches[0].clientY;
});

document.addEventListener('touchmove', e => {
    const touchY = e.touches[0].clientY;
    const diff = touchY - touchStartY;
    
    if(diff > 100) {
        const currentApp = document.querySelector('.app-screen[style*="flex"]');
        if(currentApp) {
            closeApp(currentApp.id.replace('-app', ''));
            playSound('close');
        }
    }
});

// Tema dinamico
function updateTheme() {
    const hour = new Date().getHours();
    const isDark = hour < 6 || hour > 18;
    document.documentElement.style.setProperty('--theme-bg', 
        isDark ? '#000' : '#fff');
    document.documentElement.style.setProperty('--theme-text', 
        isDark ? '#fff' : '#000');
}

// Controllo volume con gesture
let volumeTimeout;
document.addEventListener('touchstart', e => {
    if(e.touches.length === 2) {
        const slider = document.querySelector('.volume-slider');
        slider.classList.add('active');
        clearTimeout(volumeTimeout);
        volumeTimeout = setTimeout(() => {
            slider.classList.remove('active');
        }, 3000);
    }
});

// Widget meteo interattivo
function updateWeather() {
    fetch('https://api.openweathermap.org/data/2.5/weather?q=Your,City&appid=YOUR_API_KEY&units=metric')
        .then(res => res.json())
        .then(data => {
            const widget = document.querySelector('.weather-widget');
            widget.querySelector('.weather-temp').textContent = 
                Math.round(data.main.temp) + '°';
            widget.querySelector('.weather-details div:first-child').textContent = 
                data.weather[0].main;
            widget.querySelector('.weather-details div:last-child').textContent = 
                `Umidità: ${data.main.humidity}%`;
        })
        .catch(() => {
            // Usa dati di fallback se l'API non funziona
        });
}

// Inizializzazione
document.addEventListener('DOMContentLoaded', () => {
    createWeatherEffect();
    updateTheme();
    setInterval(updateTheme, 60000);
    updateWeather();
    setInterval(updateWeather, 600000);
    
    // Aggiungi suoni alle interazioni
    document.querySelectorAll('.app, .dock-icon').forEach(el => {
        el.addEventListener('click', () => playSound('tap'));
    });
});

// Aggiorna la data di compleanno
const birthdayDate = new Date('2025-06-24');
const now = new Date();
const diff = birthdayDate - now;
const days = Math.floor(diff / (1000 * 60 * 60 * 24));

document.querySelector('.birthday-message').textContent = 
    `Mancano ${days} giorni al tuo compleanno!`;

// Effetti particellari
function createParticles() {
    const particles = document.querySelector('.particles');
    for (let i = 0; i < 50; i++) {
        const particle = document.createElement('div');
        particle.style.cssText = `
            position: absolute;
            width: 3px;
            height: 3px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            top: ${Math.random() * 100}%;
            left: ${Math.random() * 100}%;
            animation: float ${5 + Math.random() * 10}s linear infinite;
        `;
        particles.appendChild(particle);
    }
}

// Modalità risparmio energetico
function checkBatteryAndEnablePowerSaving() {
    if ('getBattery' in navigator) {
        navigator.getBattery().then(battery => {
            if (battery.level < 0.2) {
                document.body.classList.add('power-saving');
                showPushNotification('Batteria scarica', 'Modalità risparmio energetico attivata');
            }
            
            battery.addEventListener('levelchange', () => {
                if (battery.level < 0.2) {
                    document.body.classList.add('power-saving');
                } else {
                    document.body.classList.remove('power-saving');
                }
            });
        });
    }
}

// Gesture di pinch-to-zoom
let initialPinchDistance = 0;
document.addEventListener('touchstart', e => {
    if (e.touches.length === 2) {
        initialPinchDistance = Math.hypot(
            e.touches[0].clientX - e.touches[1].clientX,
            e.touches[0].clientY - e.touches[1].clientY
        );
    }
});

document.addEventListener('touchmove', e => {
    if (e.touches.length === 2) {
        const currentDistance = Math.hypot(
            e.touches[0].clientX - e.touches[1].clientX,
            e.touches[0].clientY - e.touches[1].clientY
        );
        const scale = currentDistance / initialPinchDistance;
        
        const currentApp = document.querySelector('.app-screen[style*="flex"]');
        if (currentApp) {
            currentApp.style.transform = `scale(${Math.min(Math.max(scale, 0.5), 1.5)})`;
        }
    }
});

// Sincronizzazione calendario
function syncCalendar() {
    const syncIndicator = document.querySelector('.sync-indicator');
    syncIndicator.classList.add('syncing');
    
    // Simula sincronizzazione con Google Calendar
    fetch('https://www.googleapis.com/calendar/v3/calendars/primary/events', {
        headers: {
            'Authorization': 'Bearer YOUR_TOKEN'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Aggiorna eventi nel calendario
        updateCalendarEvents(data.items);
        syncIndicator.classList.remove('syncing');
        showPushNotification('Calendario', 'Sincronizzazione completata');
    })
    .catch(error => {
        syncIndicator.classList.remove('syncing');
        showPushNotification('Errore', 'Sincronizzazione calendario fallita');
    });
}

// Sistema di notifiche push
function showPushNotification(title, message, duration = 3000) {
    const notification = document.getElementById('pushNotification');
    notification.querySelector('.notification-title').textContent = title;
    notification.querySelector('.notification-body').textContent = message;
    notification.classList.add('show');
    
    setTimeout(() => {
        notification.classList.remove('show');
    }, duration);
}

// Rotazione dispositivo
window.addEventListener('deviceorientation', (event) => {
    const rotation = event.gamma; // -90 to 90
    document.documentElement.style.setProperty('--rotation', `${rotation}deg`);
});

// Inizializzazione delle nuove funzionalità
document.addEventListener('DOMContentLoaded', () => {
    createParticles();
    checkBatteryAndEnablePowerSaving();
    
    // Sincronizza calendario ogni 30 minuti
    syncCalendar();
    setInterval(syncCalendar, 30 * 60 * 1000);
    
    // Gestione notifiche di compleanno
    const birthdayDate = new Date('2025-06-24');
    const now = new Date();
    const daysUntilBirthday = Math.ceil((birthdayDate - now) / (1000 * 60 * 60 * 24));
    
    if (daysUntilBirthday <= 7) {
        showPushNotification(
            '🎂 Compleanno in arrivo!',
            `Mancano solo ${daysUntilBirthday} giorni al tuo compleanno!`
        );
    }
});

// Gesture per chiudere le app (aggiornato)
let touchStartY = 0;
let touchStartX = 0;

document.addEventListener('touchstart', e => {
    touchStartY = e.touches[0].clientY;
    touchStartX = e.touches[0].clientX;
});

document.addEventListener('touchmove', e => {
    const touchY = e.touches[0].clientY;
    const touchX = e.touches[0].clientX;
    const diffY = touchY - touchStartY;
    const diffX = touchX - touchStartX;
    
    const currentApp = document.querySelector('.app-screen[style*="flex"]');
    if (currentApp) {
        if (diffY > 100 && Math.abs(diffX) < 50) {
            // Swipe verticale
            closeApp(currentApp.id.replace('-app', ''));
            playSound('close');
        } else if (Math.abs(diffX) > 100) {
            // Swipe orizzontale per switcher app
            currentApp.style.transform = `translateX(${diffX}px)`;
        }
    }
});

document.addEventListener('touchend', e => {
    const currentApp = document.querySelector('.app-screen[style*="flex"]');
    if (currentApp) {
        currentApp.style.transform = '';
    }
});
  </script>
</body>
</html>
